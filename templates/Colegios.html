<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Books | Colegios</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Instrument+Sans:wght@300;400;700&family=Outfit:wght@600;800;900&display=swap" rel="stylesheet">
    
    <style>
        /* Estilos del diseño (Mantienen la consistencia) */
        .font-outfit { font-family: 'Outfit', sans-serif; }
        .font-instrument { font-family: 'Instrument Sans', sans-serif; }
        .bg-brand-primary { background-color: #163D6A; }
        .text-brand-primary { color: #163D6A; }
        .bg-brand-accent { background-color: #163d6a; }
        .text-active { color: #163D6A; }
        /* Color Amarillo del botón superior */
        .bg-brand-secondary { background-color: #fcd34d; } /* Amarillo 400 */
        .hover\:bg-brand-secondary:hover { background-color: #facc15; } /* Amarillo 500 */


        .dropdown:hover .dropdown-menu { display: block; opacity: 1; transform: translateY(0); visibility: visible; }
        .dropdown-menu { display: none; opacity: 0; visibility: hidden; transition: all 0.3s ease-out; transform: translateY(10px); z-index: 50; min-width: 14rem; }
        .search-input { width: 100%; padding: 0.75rem 1.75rem; border: 1px solid #d1d5db; border-radius: 9999px; outline: none; transition: border-color 0.3s; }
        .search-input:focus { border-color: #163d6a; }
        .search-button-separate { width: 52px; height: 52px; margin-left: 12px; background-color: #163d6a; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .icon-white { filter: brightness(0) invert(1); }
        .menu-item { padding: 0 1.25rem; display: flex; align-items: center; height: 100%; border-bottom: 4px solid transparent; transition: all 0.2s ease-in-out; }
        .menu-item:hover, .menu-item.active { color: #163d6a; border-bottom-color: #163D6A; }
        .whatsapp-float { position: fixed; width: 55px; height: 55px; bottom: 30px; right: 30px; background-color: #25d366; color: #FFF; border-radius: 50%; text-align: center; font-size: 28px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); z-index: 1000; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(37, 211, 102, 0); } 100% { box-shadow: 0 0 0 0 rgba(37, 211, 102, 0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        /* ESTILO PARA SCROLL REVEAL (NO AFECTA A package-card AHORA) */
        .animate-scroll-reveal { opacity: 0; animation: slideUp 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards; }

        /* --- ESTILO CORREGIDO DEL DROPBOX CON BÚSQUEDA (Z-INDEX ALTO) --- */
        .custom-dropdown-menu { 
            max-height: 250px; 
            overflow-y: auto; 
            display: none; 
            opacity: 0; 
            visibility: hidden; 
            transition: all 0.3s ease-out; 
            transform: translateY(10px); 
            z-index: 60; /* ¡CORRECCIÓN CLAVE! */
            position: absolute; /* Aseguramos que se posicione correctamente */
        }
        .custom-dropdown.active .custom-dropdown-menu { display: block; opacity: 1; transform: translateY(0); visibility: visible; }
        
        /* Aseguramos que el contenedor del colegio esté arriba */
        .custom-dropdown {
            position: relative;
            z-index: 60; /* Contenedor padre con z-index alto */
        }

        /* El menú de cursos puede tener un z-index más bajo */
        .course-dropdown-menu { 
            opacity: 0; 
            visibility: hidden; 
            max-height: 0; 
            transition: opacity 0.3s ease-out, transform 0.3s ease-out, max-height 0.3s ease-out; 
            transform: translateY(-10px); 
            z-index: 50; 
            overflow-y: hidden; /* Oculta el scrollbar cuando está colapsado */
        }
        .course-dropdown.active .course-dropdown-menu { 
            opacity: 1; 
            visibility: visible; 
            max-height: 250px; 
            transform: translateY(0); 
            overflow-y: auto; /* Permite scroll cuando está activo */
        }
        
        #search-loading { 
            display: none; 
            transition: opacity 0.3s; 
            /* Agregamos una altura mínima para el loading para que no se vea feo al cargar */
            min-height: 150px; 
        }
        
        /* Estilo para el botón de colegio al cargar */
        .school-loading { 
            background-color: #f3f4f6;
            color: #9ca3af;
            cursor: wait !important;
        }
        
        /* Estilo para el contenedor del curso antes de aparecer (Oculto Inicialmente) */
        .course-dropdown-container-hidden {
            opacity: 0;
            max-height: 0;
            overflow: hidden;
            transition: opacity 0.5s ease-out, max-height 0.5s ease-out;
            margin-top: 0;
        }

        .course-dropdown-container-visible {
            opacity: 1;
            max-height: 200px; /* Ajusta esto según el padding y altura real */
            transition: opacity 0.5s ease-in, max-height 0.5s ease-in;
            margin-top: 1.5rem; /* space-y-6 */
        }


        /* --- ESTILOS MEJORADOS DEL NUEVO BANNER (package-card) --- */
        #package-card {
            display: flex; /* Usamos flexbox para el diseño de banner */
            align-items: center;
            padding: 2rem; /* Más padding */
            max-width: none; /* De lado a lado */
            border-radius: 0.75rem; /* rounded-xl */
            background: linear-gradient(135deg, #163D6A 0%, #205797 100%); /* Azul fuerte de fondo */
            color: white; /* Texto blanco por defecto */
            border-top: 6px solid #fcd34d; /* Línea amarilla fuerte */
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 8px 10px -6px rgba(0, 0, 0, 0.2); /* Sombra intensa */
        }
        
        /* Ajustes de color dentro de la tarjeta */
        #package-card h3 {
            color: #fcd34d; /* Título en amarillo */
        }
        
        #package-card .text-brand-primary-card-mod {
            color: #fcd34d; /* Para cantidades y textos importantes */
        }
        
        #package-card .text-gray-800-card-mod {
            color: #d1d5db; /* Texto para labels */
        }
        
        /* Estilo para el botón "Añadir Kit Completo al Carrito" */
        .btn-add-to-cart {
            transition: all 0.3s ease;
            background-color: #fcd34d; /* Amarillo base */
            color: #1f2937; /* Texto oscuro */
            font-size: 1.125rem; /* text-lg */
        }
        .btn-add-to-cart:hover {
            background-color: #facc15 !important; /* Amarillo 500 */
            color: #1f2937 !important; /* Texto oscuro */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05), 0 0 0 4px #f59e0b; /* Sombra y anillo amarillo más intenso (500) */
        }
    </style>
</head>

<body class="font-instrument text-gray-700 bg-white antialiased">

    <div class="bg-gray-100 border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-2 text-sm flex justify-between items-center">
            <div class="flex-grow text-center text-gray-700 font-outfit font-semibold text-sm sm:text-base tracking-wider">
                Encuentra <span class="font-black text-gray-800">AQUÍ</span> los textos escolares de las mejores casas editoriales
            </div>
            <div class="flex space-x-3 items-center text-gray-500 flex-shrink-0">
                <a href="https://www.facebook.com/smartbookscol" target="_blank" class="hover:text-brand-primary"><i class="fab fa-facebook-f text-lg"></i></a>
                <a href="https://www.instagram.com/smartbookscol" target="_blank" class="hover:text-brand-primary"><i class="fab fa-instagram text-lg"></i></a>
                <a href="https://www.linkedin.com/company/smartbookscol/" target="_blank" class="hover:text-brand-primary"><i class="fab fa-linkedin-in text-lg"></i></a>
            </div>
        </div>
    </div>

    <header class="bg-white sticky top-0 z-50 shadow-md">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <a href="/" class="flex-shrink-0">
                <img src="https://sbooks.com.co/wp-content/uploads/2022/10/Logo-Azul-2048x1078.png" alt="Logo Smart Books Holding" class="h-20 w-auto">
            </a>
            <form action="#" class="relative max-w-xl flex-grow mx-10 hidden lg:block">
                <div class="flex items-center">
                    <input type="text" placeholder="Buscar por palabra clave..." class="search-input text-gray-700 text-lg">
                    <button type="submit" class="search-button-separate" title="Buscar">
                        <img src="https://cdn-icons-png.flaticon.com/128/3031/3031293.png" alt="Lupa" class="w-7 h-7 icon-white">
                    </button>
                </div>
            </form>
            <div class="flex space-x-6 items-center">
                <a href="#" class="hidden xl:flex items-center justify-center bg-yellow-400 text-gray-900 font-outfit font-bold px-5 py-3 rounded-lg shadow-lg hover:bg-yellow-500 transition transform duration-300 animate-super-pulse">
                    <span class="text-base">Compra tu Kit Educativo AQUÍ</span>
                </a>
                <div class="flex space-x-4 items-center text-gray-800 text-xl">
                    <a href="#" class="p-2 hover:text-brand-primary transition duration-300 relative flex items-center justify-center" title="Carrito de Compras">
                        <img src="https://cdn-icons-png.flaticon.com/128/3144/3144456.png" alt="Carrito" class="w-8 h-8">
                        <span class="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-0.5 text-xs font-bold leading-none text-white transform translate-x-1/2 -translate-y-1/2 bg-brand-accent rounded-full">
                            0
                        </span>
                    </a>
                </div>
                <button class="lg:hidden p-2 text-gray-800 hover:text-brand-primary transition duration-300">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </div>

        <div class="bg-white border-t border-gray-100 hidden lg:block shadow-sm h-14">
            <div class="max-w-7xl mx-auto px-4 h-full">
                <nav class="flex justify-center h-full">
                    <div class="dropdown relative h-full">
                        <a href="/textos-escolares" class="menu-item active"> Textos Escolares </a>
                    </div>
                    <div class="dropdown relative h-full">
                        <a href="#" class="menu-item flex items-center"> Novedades <i class="fas fa-chevron-down text-xs ml-1 transition-transform transform group-hover:rotate-180"></i> </a>
                        <div class="dropdown-menu absolute bg-white shadow-xl rounded-b-md w-56 border-t-2 border-brand-accent top-full">
                            <a href="/lanzamientos" class="block px-5 py-3 text-gray-800 hover:bg-gray-100 hover:text-active transition duration-300 text-sm">Lanzamientos</a>
                            <a href="/promociones" class="block px-5 py-3 text-gray-800 hover:bg-gray-100 hover:text-active transition duration-300 text-sm">Promociones</a>
                            <a href="/eventos" class="block px-5 py-3 text-gray-800 hover:bg-gray-100 hover:text-active transition duration-300 text-sm">Eventos</a>
                        </div>
                    </div>
                    <div class="dropdown relative h-full">
                        <a href="/quienes-somos" class="menu-item"> Quiénes Somos </a>
                    </div>
                    <div class="dropdown relative h-full">
                        <a href="#" class="menu-item flex items-center"> Ayuda <i class="fas fa-chevron-down text-xs ml-1 transition-transform transform group-hover:rotate-180"></i> </a>
                        <div class="dropdown-menu absolute bg-white shadow-xl rounded-b-md w-56 border-t-2 border-brand-accent top-full">
                            <a href="/quienes-somos" class="block px-5 py-3 text-gray-800 hover:bg-gray-100 hover:text-active transition duration-300 text-sm">Quienes Somos</a>
                            <a href="/terminos-y-condiciones" class="block px-5 py-3 text-gray-800 hover:bg-gray-100 hover:text-active transition duration-300 text-sm">Términos y Condiciones</a>
                            <a href="/preguntas-frecuentes" class="block px-5 py-3 text-gray-800 hover:bg-gray-100 hover:text-active transition duration-300 text-sm">Preguntas Frecuentes – FAQ</a>
                        </div>
                    </div>
                    <div class="dropdown relative h-full">
                        <a href="#" class="menu-item flex items-center"> Aliados <i class="fas fa-chevron-down text-xs ml-1 transition-transform transform group-hover:rotate-180"></i> </a>
                        <div class="dropdown-menu absolute bg-white shadow-xl rounded-b-md w-40 border-t-2 border-brand-accent top-full">
                            <a href="/aliados/castillo" class="block px-5 py-3 text-gray-800 hover:bg-gray-100 hover:text-active transition duration-300 text-sm">Castillo</a>
                            <a href="/aliados/macmillan" class="block px-5 py-3 text-gray-800 hover:bg-gray-100 hover:text-active transition duration-300 text-sm">Macmillan</a>
                            <a href="/aliados/sm" class="block px-5 py-3 text-gray-800 hover:bg-gray-100 hover:text-active transition duration-300 text-sm">SM</a>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </header>

    <main class="py-12 md:py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

            <div class="text-center mb-12 animate-scroll-reveal" style="animation-delay: 0.1s;">
                <h1 class="font-outfit text-4xl sm:text-5xl font-extrabold text-brand-primary mb-3">
                    Encuentra tus Textos Escolares
                </h1>
                <p class="text-gray-600 text-xl font-instrument">
                    Selecciona tu colegio y curso para ver el paquete educativo exacto.
                </p>
            </div>

            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-24 bg-white shadow-2xl rounded-2xl border border-gray-100 animate-scroll-reveal" style="animation-delay: 0.3s;">
                
                <h2 class="font-outfit text-3xl font-bold text-gray-800 mb-8 text-center">
                    Localiza tu Kit Educativo
                </h2>

                <div class="mb-6 custom-dropdown relative z-60" id="school-dropdown-container">
                    <label for="school-select-button" class="block text-sm font-medium text-gray-700 mb-2">Paso 1: Selecciona tu Colegio</label>
                    <div class="relative">
                        <button type="button" id="school-select-button" class="w-full text-left bg-gray-50 border border-gray-300 rounded-lg shadow-sm px-4 py-3 text-lg font-semibold text-gray-700 hover:border-brand-primary transition duration-300 flex justify-between items-center" aria-haspopup="true" aria-expanded="false" aria-controls="school-list">
                            <span id="selected-school-name">Busca o selecciona un colegio</span>
                            <i class="fas fa-chevron-down text-base ml-2 transition-transform duration-300"></i>
                        </button>
                        <div id="school-dropdown-menu" class="custom-dropdown-menu absolute mt-1 w-full rounded-lg shadow-xl bg-white border border-gray-200 p-2 transform origin-top-right" role="menu" aria-orientation="vertical" aria-labelledby="school-select-button">
                            <input type="text" id="school-search-input" placeholder="Escribe el nombre del colegio..." class="search-input text-sm mb-2" onfocus="this.value=''" autocomplete="off">
                            <div id="school-list" class="space-y-1">
                                <p id="school-loading" class="text-center p-3 text-gray-500">Cargando colegios...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="course-dropdown-container-hidden" id="course-dropdown-container">
                    <div class="course-dropdown relative z-50">
                        <label for="course-select-button" class="block text-sm font-medium text-gray-700 mb-2">Paso 2: Selecciona tu Curso</label>
                        <button type="button" id="course-select-button" class="w-full text-left bg-white border border-gray-300 rounded-lg shadow-sm px-4 py-3 text-lg font-semibold text-gray-500 hover:border-brand-primary transition duration-300 flex justify-between items-center" aria-haspopup="true" aria-expanded="false" disabled>
                            <span id="selected-course-name">Selecciona un curso</span>
                            <i class="fas fa-chevron-down text-base ml-2 transition-transform duration-300"></i>
                        </button>
                        <div id="course-dropdown-menu" class="course-dropdown-menu absolute mt-1 w-full rounded-lg shadow-xl bg-white border border-gray-200 p-2 transform origin-top-right" role="menu" aria-orientation="vertical" aria-labelledby="course-select-button">
                            <div id="course-list" class="space-y-1">
                                </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-8 text-center" id="result-container">
                    <p id="initial-message" class="text-xl text-gray-500 font-instrument">
                        Por favor, selecciona un colegio para empezar.
                    </p>
                    
                    <div id="search-loading" class="flex flex-col items-center justify-center p-8 text-brand-primary">
                        <i class="fas fa-spinner fa-spin text-4xl mb-3"></i>
                        <p class="text-lg font-semibold">Buscando paquete educativo...</p>
                    </div>

                    <div id="package-card" class="mt-12 animate-scroll-reveal hidden" style="animation-delay: 0.5s;">
                        <div id="card-content" class="md:flex md:space-x-8 items-start justify-between w-full">
                            
                            <div class="flex flex-col items-center flex-shrink-0 mb-6 md:mb-0 md:items-start w-full md:w-auto">
                                <div id="card-imagen-container" class="flex-shrink-0 mb-4 md:mb-0">
                                    <img id="card-imagen" src="" alt="Logo del Colegio" class="w-24 h-24 object-contain rounded-full bg-white p-1 shadow-inner">
                                </div>
                                <div class="flex-grow min-w-0 text-center md:text-left">
                                    <p class="text-xs font-outfit uppercase tracking-widest text-brand-secondary font-bold mb-1">Paquete Educativo Encontrado</p>
                                    <h3 id="package-title" class="font-outfit text-xl sm:text-2xl font-black mb-4 leading-snug"></h3>
                                    <div class="flex flex-wrap gap-x-6 gap-y-2 text-sm text-gray-200 mb-4 justify-center md:justify-start" id="package-details-summary">
                                        <p><span class="font-semibold text-gray-800-card-mod">Colegio:</span> <span id="card-colegio"></span></p>
                                        <p><span class="font-semibold text-gray-800-card-mod">Curso:</span> <span id="card-curso"></span></p>
                                        <p><span class="font-semibold text-gray-800-card-mod">Libros:</span> <span id="card-cantidad-libros" class="font-bold text-brand-primary-card-mod"></span></p>
                                    </div>
                                    <a href="#" id="card-map-link" target="_blank" class="text-brand-secondary hover:text-yellow-300 transition duration-300 text-sm font-semibold flex items-center justify-center md:justify-start">
                                        <i class="fas fa-map-marker-alt mr-2"></i> Ver Ubicación del Colegio
                                    </a>
                                </div>
                            </div>
                            
                            <div class="md:w-1/2 w-full text-center md:text-left">
                                <p class="font-semibold text-white mb-2">Libros incluidos en tu paquete:</p>
                                <div id="kits-detail-list" class="max-h-40 overflow-y-auto custom-scrollbar pr-2">
                                    </div>

                                <button class="btn-add-to-cart w-full md:w-auto mt-6 px-8 py-3 rounded-xl font-outfit font-black uppercase shadow-lg hover:shadow-xl focus:outline-none focus:ring-4 transition duration-300">
                                    <i class="fas fa-cart-plus mr-2"></i> Añadir Kit Completo al Carrito
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </main>
    
    <a href="https://wa.me/573017777777" class="whatsapp-float" target="_blank" title="Contáctanos por WhatsApp">
        <i class="fab fa-whatsapp"></i>
    </a>
    
    <footer class="bg-gray-800 text-white mt-20">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div class="lg:col-span-1">
                    <img src="https://sbooks.com.co/wp-content/uploads/2022/10/Logo-Blanco-2048x1078.png" alt="Logo Smart Books Holding Blanco" class="h-16 w-auto mb-4">
                    <p class="text-sm text-gray-400">Distribución de textos escolares y material educativo de las mejores casas editoriales.</p>
                </div>
                <div class="lg:col-span-1">
                    <h4 class="font-outfit text-lg font-semibold text-white mb-4">Explorar</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="/textos-escolares" class="hover:text-brand-secondary transition duration-300">Textos Escolares</a></li>
                        <li><a href="/quienes-somos" class="hover:text-brand-secondary transition duration-300">Quiénes Somos</a></li>
                        <li><a href="/novedades" class="hover:text-brand-secondary transition duration-300">Novedades</a></li>
                        <li><a href="/contacto" class="hover:text-brand-secondary transition duration-300">Contacto</a></li>
                    </ul>
                </div>
                <div class="lg:col-span-1">
                    <h4 class="font-outfit text-lg font-semibold text-white mb-4">Ayuda</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="/preguntas-frecuentes" class="hover:text-brand-secondary transition duration-300">Preguntas Frecuentes</a></li>
                        <li><a href="/terminos-y-condiciones" class="hover:text-brand-secondary transition duration-300">Términos y Condiciones</a></li>
                        <li><a href="/politica-privacidad" class="hover:text-brand-secondary transition duration-300">Política de Privacidad</a></li>
                    </ul>
                </div>
                <div class="lg:col-span-1">
                    <h4 class="font-outfit text-lg font-semibold text-gray-900 mb-4">Encuéntranos</h4>
                    <div class="w-full rounded-lg overflow-hidden shadow-md">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d618.676350650165!2d-74.05854276815452!3d4.753396005441487!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e3f85a3816c4b63%3A0xbdecd40be274ea2!2sSmart%20Books%20Colombia!5e1!3m2!1ses-419!2sco!4v1760823591513!5m2!1ses-4" width="100%" height="200" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-8 pt-6 flex justify-between items-center text-sm text-gray-500">
                <p>&copy; 2025 Smart Books. Todos los derechos reservados.</p>
                <div class="flex space-x-3">
                    <a href="https://www.facebook.com/smartbookscol" target="_blank" class="hover:text-white"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://www.instagram.com/smartbookscol" target="_blank" class="hover:text-white"><i class="fab fa-instagram"></i></a>
                    <a href="https://www.linkedin.com/company/smartbookscol/" target="_blank" class="hover:text-white"><i class="fab fa-linkedin-in"></i></a>
                </div>
            </div>
        </div>
    </footer>
    

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- 1. REFERENCIAS DE ELEMENTOS DOM ---
            const schoolDropdownContainer = document.getElementById('school-dropdown-container');
            const schoolSelectButton = document.getElementById('school-select-button');
            const schoolSearchInput = document.getElementById('school-search-input');
            const schoolList = document.getElementById('school-list');
            const selectedSchoolName = document.getElementById('selected-school-name');

            const courseDropdownContainer = document.getElementById('course-dropdown-container');
            const courseSelectButton = document.getElementById('course-select-button');
            const courseDropdownMenu = document.getElementById('course-dropdown-menu');
            const courseList = document.getElementById('course-list');
            const selectedCourseName = document.getElementById('selected-course-name');
            
            const initialMessage = document.getElementById('initial-message');
            const searchLoading = document.getElementById('search-loading');
            const packageCard = document.getElementById('package-card'); // La tarjeta principal
            
            // --- 2. DATOS SIMULADOS DEL BACKEND ---
            // Simulación de los datos de los colegios
            const ALL_SCHOOLS = [
                { ID_COLEGIO: '0001', COLEGIO: 'INSTITUTO SAN JUAN BOSCO', CIUDAD: 'BOGOTA', PREJARDIN: 'PAQUETE EDUCATIVO San Juan Bosco - PRE JARDÍN', JARDIN: 'PAQUETE EDUCATIVO San Juan Bosco - JARDÍN', TRANSICION: 'PAQUETE EDUCATIVO San Juan Bosco - TRANSICIÓN', PRIMERO: 'PAQUETE EDUCATIVO San Juan Bosco - 1°', SEGUNDO: 'PAQUETE EDUCATIVO San Juan Bosco - 2°', TERCERO: 'PAQUETE EDUCATIVO San Juan Bosco - 3°', CUARTO: 'PAQUETE EDUCATIVO San Juan Bosco - 4°', QUINTO: 'PAQUETE EDUCATIVO San Juan Bosco - 5°', SEXTO: 'PAQUETE EDUCATIVO San Juan Bosco - 6°', SEPTIMO: 'PAQUETE EDUCATIVO San Juan Bosco - 7°', OCTAVO: 'PAQUETE EDUCATIVO San Juan Bosco - 8°', NOVENO: 'PAQUETE EDUCATIVO San Juan Bosco - 9°', DECIMO: 'PAQUETE EDUCATIVO San Juan Bosco - 10°', ONCE: 'PAQUETE EDUCATIVO San Juan Bosco - 11°', IMAGEN: 'https://sbooks.com.co/wp-content/uploads/2024/12/sanjuanbosco.jpg', UBICACION: 'https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d618.676350650165!2d-74.05854276815452!3d4.753396005441487!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8e3f85a3816c4b63%3A0xbdecd40be274ea2!2sSmart%20Books%20Colombia!5e1!3m2!1ses-419!2sco!4v1760823591513!5m2!1ses-4' },
                { ID_COLEGIO: '0012', COLEGIO: 'PSICOPEDAGÓGICO DE SUBA', CIUDAD: 'BOGOTA', PREJARDIN: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - PRE JARDÍN', JARDIN: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - JARDÍN', TRANSICION: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - TRANSICIÓN', PRIMERO: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - 1°', SEGUNDO: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - 2°', TERCERO: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - 3°', CUARTO: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - 4°', QUINTO: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - 5°', SEXTO: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - 6°', SEPTIMO: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - 7°', OCTAVO: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - 8°', NOVENO: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - 9°', DECIMO: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - 10°', ONCE: 'PAQUETE EDUCATIVO Psicopedagógico de Suba - 11°', IMAGEN: 'https://sbooks.com.co/wp-content/uploads/2025/02/psicopeda.jpg', UBICACION: 'https://maps.app.goo.gl/NQ8H69rLrKxZcmsK6' },
                { ID_COLEGIO: '0002', COLEGIO: 'COLEGIO DE LA SALLE', CIUDAD: 'BOGOTA', PREJARDIN: '0', JARDIN: 'PAQUETE EDUCATIVO La Salle - JARDÍN', TRANSICION: 'PAQUETE EDUCATIVO La Salle - TRANSICIÓN', PRIMERO: 'PAQUETE EDUCATIVO La Salle - 1°', SEGUNDO: 'PAQUETE EDUCATIVO La Salle - 2°', TERCERO: 'PAQUETE EDUCATIVO La Salle - 3°', CUARTO: 'PAQUETE EDUCATIVO La Salle - 4°', QUINTO: 'PAQUETE EDUCATIVO La Salle - 5°', SEXTO: 'PAQUETE EDUCATIVO La Salle - 6°', SEPTIMO: 'PAQUETE EDUCATIVO La Salle - 7°', OCTAVO: 'PAQUETE EDUCATIVO La Salle - 8°', NOVENO: 'PAQUETE EDUCATIVO La Salle - 9°', DECIMO: 'PAQUETE EDUCATIVO La Salle - 10°', ONCE: 'PAQUETE EDUCATIVO La Salle - 11°', IMAGEN: 'https://sbooks.com.co/wp-content/uploads/2022/11/lasalle.png', UBICACION: 'https://www.google.com/maps/place/Gimnasio+San+Angelo/@4.8013523,-74.0463802,1104m/data=!3m1!1e3!4m6!3m5!1s0x8e3f8616da249b53:0xab6aeb0b622dcf1!8m2!3d4.8013655!4d-74.0448845!16s%2Fg%2F11b6g89sgp?entry=ttu&g_ep=EgoyMDI1MTAyOS4yIKXMDSoASAFQAw%3D%3D' },
                { ID_COLEGIO: '0003', COLEGIO: 'CAFAM', CIUDAD: 'BOGOTA', PREJARDIN: '0', JARDIN: '0', TRANSICION: 'PAQUETE EDUCATIVO CAFAM 68 - TRANSICIÓN', PRIMERO: 'PAQUETE EDUCATIVO CAFAM 68 - 1°', SEGUNDO: 'PAQUETE EDUCATIVO CAFAM 68 - 2°', TERCERO: 'PAQUETE EDUCATIVO CAFAM 68 - 3°', CUARTO: 'PAQUETE EDUCATIVO CAFAM 68 - 4°', QUINTO: 'PAQUETE EDUCATIVO CAFAM 68 - 5°', SEXTO: 'PAQUETE EDUCATIVO CAFAM 68 - 6°', SEPTIMO: 'PAQUETE EDUCATIVO CAFAM 68 - 7°', OCTAVO: 'PAQUETE EDUCATIVO CAFAM 68 - 8°', NOVENO: 'PAQUETE EDUCATIVO CAFAM 68 - 9°', DECIMO: 'PAQUETE EDUCATIVO CAFAM 68 - 10°', ONCE: 'PAQUETE EDUCATIVO CAFAM 68 - 11°', IMAGEN: 'https://sbooks.com.co/wp-content/uploads/2024/12/no-image.png', UBICACION: 'http://googleusercontent.com/maps.google.com/cafam' },
                { ID_COLEGIO: '0011', COLEGIO: 'TECNOLOGICO DEL SUR', CIUDAD: 'BOGOTA', PREJARDIN: '0', JARDIN: '0', TRANSICION: '0', PRIMERO: 'PAQUETE DE INGLÉS Tecnológico del Sur - 1°', SEGUNDO: 'PAQUETE DE INGLÉS Tecnológico del Sur - 2°', TERCERO: 'PAQUETE DE INGLÉS Tecnológico del Sur - 3°', CUARTO: 'PAQUETE DE INGLÉS Tecnológico del Sur - 4°', QUINTO: 'PAQUETE DE INGLÉS Tecnológico del Sur - 5°', SEXTO: 'PAQUETE DE INGLÉS Tecnológico del Sur - 6°', SEPTIMO: 'PAQUETE DE INGLÉS Tecnológico del Sur - 7°', OCTAVO: 'PAQUETE DE INGLÉS Tecnológico del Sur - 8°', NOVENO: 'PAQUETE DE INGLÉS Tecnológico del Sur - 9°', DECIMO: 'PAQUETE DE INGLÉS Tecnológico del Sur - 10°', ONCE: 'PAQUETE DE INGLÉS Tecnológico del Sur - 11°', IMAGEN: 'https://sbooks.com.co/wp-content/uploads/2024/12/no-image.png', UBICACION: 'http://googleusercontent.com/maps.google.com/tecnologico' },
            ];
            
            // Mapeo de las llaves del JSON a nombres legibles para el usuario
            const GRADE_MAP = {
                PREJARDIN: 'Pre-Jardín',
                JARDIN: 'Jardín',
                TRANSICION: 'Transición',
                PRIMERO: '1° Primero',
                SEGUNDO: '2° Segundo',
                TERCERO: '3° Tercero',
                CUARTO: '4° Cuarto',
                QUINTO: '5° Quinto',
                SEXTO: '6° Sexto',
                SEPTIMO: '7° Séptimo',
                OCTAVO: '8° Octavo',
                NOVENO: '9° Noveno',
                DECIMO: '10° Décimo',
                ONCE: '11° Once'
            };

            let selectedSchool = null; // Variable global para el colegio seleccionado

            // --- 3. FUNCIONES DE LÓGICA ---
            
            // Carga inicial y simulación de API
            function loadSchools() {
                // Simula una carga de 1.5 segundos
                setTimeout(() => {
                    renderSchoolList(ALL_SCHOOLS);
                    document.getElementById('school-loading').style.display = 'none';

                    // Reactivar el botón después de la carga
                    schoolSelectButton.classList.remove('school-loading', 'text-gray-500');
                    schoolSelectButton.classList.add('text-gray-700', 'hover:border-brand-primary');
                    schoolSelectButton.disabled = false;
                    schoolSearchInput.disabled = false;
                    
                    initialMessage.textContent = 'Por favor, selecciona un colegio para empezar.';
                }, 1500);
            }


            // Renderiza la lista de colegios en el dropdown (basada en el array filtrado)
            function renderSchoolList(schools) {
                schoolList.innerHTML = '';
                if (schools.length === 0) {
                    schoolList.innerHTML = '<p class="text-center p-3 text-gray-500">No se encontraron colegios.</p>';
                }

                schools.forEach(school => {
                    const item = document.createElement('a');
                    item.href = '#';
                    item.className = 'block px-3 py-2 text-gray-800 hover:bg-gray-100 hover:text-brand-primary transition duration-300 text-sm rounded-md';
                    item.textContent = school.COLEGIO + ' (' + school.CIUDAD + ')';
                    
                    // Usamos una función anónima para pasar el objeto colegio completo
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        handleSchoolSelection(school);
                        schoolDropdownContainer.classList.remove('active');
                    });
                    schoolList.appendChild(item);
                });
            }

            // Maneja la selección de colegio (Muestra Dropdown 2)
            function handleSchoolSelection(school) {
                selectedSchool = school;
                
                // 1. Actualiza el botón de colegio
                selectedSchoolName.textContent = school.COLEGIO;
                
                // 2. Muestra y habilita el dropdown de curso
                courseDropdownContainer.classList.remove('course-dropdown-container-hidden');
                courseDropdownContainer.classList.add('course-dropdown-container-visible');
                courseSelectButton.disabled = false;
                courseSelectButton.classList.remove('text-gray-500');
                courseSelectButton.classList.add('text-gray-700', 'hover:border-brand-primary');

                // 3. Renderiza la lista de cursos disponibles
                renderCourseList(school);
                
                // 4. Resetear la selección de curso y ocultar resultados
                selectedCourseName.textContent = 'Selecciona un curso';
                courseSelectButton.innerHTML = 'Selecciona un curso' + `<i class="fas fa-chevron-down text-base ml-2 transition-transform duration-300"></i>`;
                packageCard.classList.add('hidden');
                initialMessage.classList.remove('hidden');
                initialMessage.textContent = `Colegio seleccionado: ${school.COLEGIO}. Ahora selecciona tu curso.`;
                searchLoading.style.display = 'none';

            }

            // Renderiza los cursos disponibles para el colegio seleccionado
            function renderCourseList(school) {
                courseList.innerHTML = '';
                
                // Itera sobre el mapa de grados y verifica si el colegio tiene un paquete para ese grado
                Object.keys(GRADE_MAP).forEach(gradeKey => {
                    // El valor es diferente de '0' o una cadena vacía
                    if (school[gradeKey] && school[gradeKey] !== '0') {
                        const gradeName = GRADE_MAP[gradeKey];
                        const item = document.createElement('a');
                        item.href = '#';
                        item.className = 'block px-3 py-2 text-gray-800 hover:bg-gray-100 hover:text-brand-primary transition duration-300 text-sm rounded-md';
                        item.textContent = gradeName;

                        item.addEventListener('click', (e) => {
                            e.preventDefault();
                            handleCourseSelection(gradeKey, gradeName, school.ID_COLEGIO);
                            courseDropdownContainer.classList.remove('active'); // Oculta el dropdown de cursos
                            courseDropdownMenu.classList.remove('active'); // Oculta el menú
                        });
                        courseList.appendChild(item);
                    }
                });

                if (courseList.children.length === 0) {
                    courseList.innerHTML = '<p class="text-center p-3 text-gray-500">No hay cursos disponibles con paquete en este momento.</p>';
                    courseSelectButton.disabled = true;
                    courseSelectButton.innerHTML = 'No hay cursos disponibles' + `<i class="fas fa-chevron-down text-base ml-2 transition-transform duration-300"></i>`;
                }
            }


            // Maneja la selección del curso (Muestra la Tarjeta de Resultado)
            async function handleCourseSelection(gradeKey, gradeName, schoolId) {
                // 1. Actualiza el botón de curso
                courseSelectButton.innerHTML = gradeName + `<i class="fas fa-chevron-down text-base ml-2 transition-transform duration-300"></i>`;
                
                // 2. Oculta la tarjeta y el mensaje inicial (para el estado de carga)
                packageCard.classList.add('hidden');
                initialMessage.classList.add('hidden');

                // 3. Inicia la animación de búsqueda
                searchLoading.style.display = 'flex'; 

                // SIMULACION de la llamada API para obtener el paquete
                await new Promise(resolve => setTimeout(resolve, 800)); // Simula un pequeño retraso

                try {
                    // Simulación: El paquete de información ya está en selectedSchool
                    const packageInfo = selectedSchool[gradeKey] ? String(selectedSchool[gradeKey]).trim() : '0';
                    
                    searchLoading.style.display = 'none';

                    if (packageInfo && packageInfo !== '0') {
                        // Paquete encontrado
                        const [title, details] = packageInfo.split(' - ');
                        const kits = details.split(',').map(item => item.trim());
                        
                        document.getElementById('package-title').textContent = title.trim();
                        document.getElementById('card-colegio').textContent = selectedSchool.COLEGIO;
                        document.getElementById('card-curso').textContent = gradeName;
                        document.getElementById('card-cantidad-libros').textContent = kits.length + ' Libros';
                        document.getElementById('card-imagen').src = selectedSchool.IMAGEN;
                        document.getElementById('card-map-link').href = selectedSchool.UBICACION;

                        // Muestra el detalle de kits
                        const kitsContainer = document.getElementById('kits-detail-list');
                        kitsContainer.innerHTML = '';
                        const ul = document.createElement('ul');
                        // Cambiamos el color de los elementos de la lista a gris claro
                        ul.className = 'list-disc list-inside mt-2 text-sm text-gray-200 space-y-1 text-left ml-4';
                        kits.forEach(kit => {
                            const li = document.createElement('li');
                            li.textContent = kit;
                            ul.appendChild(li);
                        });
                        kitsContainer.appendChild(ul);

                        // Muestra el mensaje de éxito y la tarjeta
                        initialMessage.textContent = '¡Felicidades! Encontramos el paquete educativo para ti.';
                        initialMessage.classList.remove('hidden');
                        packageCard.classList.remove('hidden'); // CRUCIAL: Muestra la tarjeta

                    } else {
                        // Paquete NO encontrado (o valor '0')
                        initialMessage.textContent = 'Lo sentimos, no encontramos un paquete educativo asociado a este curso. Intenta seleccionando otro curso o contáctanos.';
                        initialMessage.classList.remove('hidden');
                        packageCard.classList.add('hidden'); // Asegura que se mantenga oculta
                    }

                } catch (error) {
                    searchLoading.style.display = 'none';
                    console.error("Error al procesar la selección del curso:", error);
                    initialMessage.textContent = 'Ocurrió un error al buscar el paquete. Por favor, inténtalo de nuevo.';
                    initialMessage.classList.remove('hidden');
                    packageCard.classList.add('hidden');
                }
            }


            // --- 4. MANEJO DE EVENTOS ---
            
            // Toggle del dropdown de Colegio
            schoolSelectButton.addEventListener('click', () => {
                schoolDropdownContainer.classList.toggle('active');
                if (courseDropdownContainer.classList.contains('active')) {
                    courseDropdownContainer.classList.remove('active');
                }
            });

            // Toggle del dropdown de Curso
            courseSelectButton.addEventListener('click', () => {
                if (!courseSelectButton.disabled) {
                    courseDropdownContainer.classList.toggle('active');
                }
            });
            
            // Ocultar dropdowns al hacer clic fuera
            document.addEventListener('click', (e) => {
                if (!schoolDropdownContainer.contains(e.target)) {
                    schoolDropdownContainer.classList.remove('active');
                }
                if (!courseDropdownContainer.contains(e.target) && !courseSelectButton.disabled) {
                    courseDropdownContainer.classList.remove('active');
                }
            });

            // Funcionalidad de búsqueda en el dropdown de colegios (filtra la lista local)
            schoolSearchInput.addEventListener('keyup', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                const filteredSchools = ALL_SCHOOLS.filter(school => 
                    school.COLEGIO.toLowerCase().includes(searchTerm) || 
                    (school.CIUDAD && school.CIUDAD.toLowerCase().includes(searchTerm))
                );
                renderSchoolList(filteredSchools);
            });
            
            // --- 5. INICIALIZACIÓN ---
            // Reemplazo de fetchSchools() por loadSchools()
            loadSchools();

            // Script para Scroll Reveal (Mantenido solo para elementos no interactivos)
            const revealElements = document.querySelectorAll('.animate-scroll-reveal');
            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = 1;
                        entry.target.style.transform = 'translateY(0)';
                        observer.unobserve(entry.target);
                    }
                });
            }, {
                threshold: 0.1
            });
            revealElements.forEach(element => {
                if (!element.style.animationDelay) {
                    element.style.animationDelay = '0s';
                }
                observer.observe(element);
            });
            
        });
    </script>

</body>
</html>